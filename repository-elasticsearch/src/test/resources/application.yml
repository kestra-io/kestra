elasticsearch:
  httpHosts: http://localhost:9200

kestra:
  repository:
    type: elasticsearch

  elasticsearch:
    indices:
      org-kestra-core-models-flows-flow:
        name: "kestra_flows"
        settings: |
          {
            "index.number_of_shards": 10
          }
        mapping: |
          {
            "properties": {
              "id": {
                "type": "keyword"
              },
              "namespace": {
                "type": "keyword"
              },
              "revision": {
                "type": "integer"
              },
              "inputs": {
                "type": "nested",
                "properties": {
                  "name": {
                    "type": "text"
                  },
                  "type": {
                    "type": "keyword"
                  },
                  "required": {
                    "type": "boolean"
                  }
                }
              },
              "tasks": {
                "type": "nested",
                "properties": {
                  "id": {
                    "type": "keyword"
                  },
                  "type": {
                    "type": "keyword"
                  }
                }
              }
            }
          }

      org-kestra-core-models-executions-execution:
        name: "kestra_executions"
        mapping: |
          {
            "properties": {
              "flowId": {
                "type": "keyword"
              },
              "flowRevision": {
                "type": "integer"
              },
              "id": {
                "type": "keyword"
              },
              "inputs": {
                "type": "object"
              },
              "namespace": {
                "type": "keyword"
              },
              "state": {
                "properties": {
                  "current": {
                    "type": "keyword"
                  },
                  "histories": {
                    "properties": {
                      "date": {
                        "type": "date"
                      },
                      "state": {
                        "type": "keyword"
                      }
                    }
                  }
                }
              },
              "taskRunList": {
                "properties": {
                  "id": {
                    "type": "text",
                    "fields": {
                      "keyword": {
                        "type": "keyword"
                      }
                    }
                  },
                  "taskId": {
                    "type": "text",
                    "fields": {
                      "keyword": {
                        "type": "keyword"
                      }
                    }
                  },
                  "state": {
                    "properties": {
                      "current": {
                        "type": "keyword"
                      },
                      "startDate": {
                        "type": "date"
                      },
                      "endDate": {
                        "type": "date"
                      },
                      "duration": {
                        "type": "long"
                      },
                      "histories": {
                        "properties": {
                          "date": {
                            "type": "date"
                          },
                          "state": {
                            "type": "keyword"
                          }
                        }
                      }
                    }
                  },
                  "logs": {
                    "properties": {
                      "level": {
                        "type": "keyword"
                      },
                      "message": {
                        "type": "text"
                      },
                      "thread": {
                        "type": "text"
                      },
                      "timestamp": {
                        "type": "date"
                      }
                    }
                  }
                }
              }
            }
          }
