id: for-each-item
namespace: io.kestra.tests

inputs:
  - name: file
    type: FILE

tasks:
  - id: each
    type: io.kestra.core.tasks.flows.ForEachItem
    items: "{{ inputs.file }}"
    maxItemsPerBatch: 4
    subFlow:
      namespace: dev
      flowId: per-item
      inputs:
        items: "{{ taskrun.items }}"
      wait: true
      transmitFailed: true